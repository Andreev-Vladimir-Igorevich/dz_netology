# Домашнее задание к занятию 11.4 "Очереди RabbitMQ" -Андреев В.И.


# Задание 1. Установка RabbitMQ

Используя Vagrant или VirtualBox, создайте виртуальную машину и установите RabbitMQ. Добавьте management plug-in и зайдите в веб интерфейс.

Итогом выполнения домашнего задания будет приложенный скриншот веб интерфейса RabbitMQ.
___
**Ответ**

![Снимок экрана от 2022-10-11 16-03-56](https://user-images.githubusercontent.com/94833070/195062442-5e3e0c98-8156-4123-86c1-d1b155094e3c.png)

# Задание 2. Отправка и получение сообщений.
Используя приложенные скрипты, проведите тестовую отправку и получение сообщения. Для отправки сообщений необходимо запустить скрипт producer.py

Для работы скриптов вам необходимо установить Python версии 3 и библиотеку pika. Также в скриптах нужно указать ip адрес машины, на которой запущен RabbitMQ, заменив localhost на нужный ip.

$ pip install pika
Зайдите в веб интерфейс, найдите очередь под названием hello и сделайте скриншот. После чего запустите второй скрипт consumer.py и сделайте скриншот результата выполнения скрипта

В качестве решения домашнего задания приложите оба скриншота, сделанных на этапе выполнения.

Для закрепления материала можете попробовать модифицировать скрипты, чтобы поменять название очереди и отправляемое сообщение.
___

**Ответ**
очередь hello 
![Снимок экрана от 2022-10-11 17-19-45](https://user-images.githubusercontent.com/94833070/195065227-16c00e1d-70ad-42f9-8e27-f8ff23bee9f9.png)

скриншот результата выполнения скрипта consumer.py
![Снимок экрана от 2022-10-11 16-17-34](https://user-images.githubusercontent.com/94833070/195062663-99e23fef-b386-4ee9-965c-06e6fdbf9646.png)

# Задание 3. Подготовка HA кластера
Используя Vagrant или VirtualBox, создайте вторую виртуальную машину и установите RabbitMQ. Добавьте в файл hosts название и ip адрес каждой машины, чтобы машины могли видеть друг друга по имени.

Пример содержимого hosts файла:

$ cat /etc/hosts
192.168.0.10 rmq01
192.168.0.11 rmq02
После этого ваши машины могут пинговаться по имени.

Затем объедините две машины в кластер и создайте политику ha-all на все очереди.

В качестве решения домашнего задания приложите скриншоты из веб интерфейса с информацией о доступных нодах в кластере и включенной политикой.

Также приложите вывод команды с двух нод:

$ rabbitmqctl cluster_status
Для закрепления материала снова запустите скрипт producer.py и приложите скриншот выполнения команды на каждой из нод:

$ rabbitmqadmin get queue='hello'
После чего попробуйте отключить одну из нод, желательно, ту к которой подключались из скрипта, затем поправьте параметры подключения в скрипте consumer.py на вторую ноду и запустите его.

Приложите скриншот результата работы второго скрипта.
___
**Ответ**

![Снимок экрана от 2022-10-11 16-04-29](https://user-images.githubusercontent.com/94833070/195062783-6276217f-76a2-4445-a7d4-c470085677f0.png)
вывод команды с двух нод: rabbitmqctl cluster_status и rabbitmqadmin get queue='hello'
![Снимок экрана от 2022-10-11 16-26-02](https://user-images.githubusercontent.com/94833070/195066274-8a24e0d9-7538-44ce-9796-1a8bdb2e8e4a.png)

Запускаю  скрипт producer.py и отключаю одну из нод и запускаю consumer.py 
вывод тот же 

![Снимок экрана от 2022-10-11 16-48-40](https://user-images.githubusercontent.com/94833070/195067362-163f381f-aede-46c7-89c5-490420703150.png)

# Дополнительные задания (со звездочкой*)
Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

# * Задание 4. Ansible playbook
Напишите плейбук, который будет производить установку RabbitMQ на любое количество нод и объединять их в кластер. При этом будет автоматически создавать политику ha-all.

Готовый плейбук разместите в своем репозитории.
